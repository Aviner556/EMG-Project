#include "myMain.h"
#include "main.h"
#include "LED.h"
#include "buttons.h"

LED blue;
LED red;
BUTTON B2;
extern TIM_HandleTypeDef htim6;


void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef * htim)
{
	ledOnTimerInterrupt(&blue);
	ledOnTimerInterrupt(&red);
}

void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin)
{
	if(GPIO_Pin == B2_Pin){
		ledOnTimerInterrupt(&red);
		ledOff(&blue);
	}
	else{
		ledOnTimerInterrupt(&blue);
		ledOff(&red);
	}
}



void mainloop()
{
	ledInit(&blue,LD2_GPIO_Port, LD2_Pin);
	ledInit(&red,LD3_GPIO_Port, LD3_Pin);

	buttInit(&B2,B2_GPIO_Port,B2_Pin);

	ledBlink(&blue, 500);
	ledBlink(&red, 200);

	__HAL_TIM_SET_COUNTER(&htim6, 0);
	HAL_TIM_Base_Start_IT(&htim6);

	while(1){

	}
}
